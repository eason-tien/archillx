# ArcHillx v1.0.0 — Environment Variables Template
# Copy this file to .env and fill in your values.
# cp .env.example .env

# ── Application ───────────────────────────────────────────────────────────────
APP_VERSION=1.0.0
LOG_LEVEL=INFO                       # DEBUG | INFO | WARNING | ERROR
HOST=0.0.0.0
PORT=8000

# ── Database ──────────────────────────────────────────────────────────────────
# DB_TYPE controls which engine is used.
# Note: SQLite is for development only. Production must use mysql or mssql.
DB_TYPE=sqlite                       # sqlite | mysql | mssql | sqlite_memory
DB_NAME=archillx                      # SQLite → archillx.db file; MySQL/MSSQL → schema name

# MySQL / MSSQL connection (only required when DB_TYPE=mysql or mssql)
# DB_HOST=localhost
# DB_PORT=3306                       # MySQL: 3306 | MSSQL: 1433
# DB_USER=archillx_user
# DB_PASSWORD=your_password_here

# MySQL connection pool tuning (production)
# DB_POOL_SIZE=5
# DB_MAX_OVERFLOW=10
# DB_POOL_TIMEOUT=30
# DB_POOL_RECYCLE=3600

# Override the full connection URL directly (optional, overrides DB_TYPE settings above)
# DATABASE_URL=mysql+pymysql://user:password@localhost:3306/archillx

# ── API Authentication ────────────────────────────────────────────────────────
# Leave blank to disable authentication (open access — only for local dev)
API_KEY=
ADMIN_TOKEN=

# ── Skills ────────────────────────────────────────────────────────────────────
SKILLS_DIR=./app/skills
EVIDENCE_DIR=./evidence
ROUTING_RULES_PATH=./configs/routing_rules.yaml

# ── Governor ──────────────────────────────────────────────────────────────────
# Modes: hard_block | soft_block | audit_only | off
GOVERNOR_MODE=soft_block
RISK_BLOCK_THRESHOLD=90              # 0–100; actions scoring >= this are blocked
RISK_WARN_THRESHOLD=70

# ── Cron ──────────────────────────────────────────────────────────────────────
CRON_TIMEZONE=Asia/Taipei

# ── AI Providers (fill in at least one) ──────────────────────────────────────

# Anthropic (Claude)
ANTHROPIC_API_KEY=sk-ant-...

# OpenAI (GPT / o-series)
OPENAI_API_KEY=sk-...
# OPENAI_BASE_URL=https://api.openai.com/v1  # override for Azure / local proxy

# Google (Gemini)
GOOGLE_API_KEY=AIza...

# Groq (fast inference — Llama / Mixtral)
GROQ_API_KEY=gsk_...

# Mistral AI
MISTRAL_API_KEY=...

# OLLAMA (local models)
OLLAMA_ENABLED=false
# OLLAMA_BASE_URL=http://localhost:11434/v1
# OLLAMA_DEFAULT_MODEL=llama3.2

# Custom / self-hosted OpenAI-compatible endpoint
# CUSTOM_MODEL_BASE_URL=https://my-api.example.com/v1
# CUSTOM_MODEL_API_KEY=sk-...

# ══════════════════════════════════════════════════════════════════════════════
#  Feature Flags — all default to false for safe gradual activation
#  Enable only what you need; each flag unlocks additional API endpoints.
# ══════════════════════════════════════════════════════════════════════════════

# ── LMF — Language Memory Framework (5-tier) ─────────────────────────────────
# Master switch — must be true for any LMF sub-flag to take effect
ENABLE_LMF=false
ENABLE_LMF_EPISODIC=false           # Timestamped event memory with evidence hashes
ENABLE_LMF_SEMANTIC=false           # Concept / entity semantic memory
ENABLE_LMF_PROCEDURAL=false         # Skill execution history & learned patterns
ENABLE_LMF_CAUSAL=false             # Causal graph: cause → effect nodes
ENABLE_LMF_WORKING=false            # Transient task-scoped working memory
ENABLE_LMF_WAL=false                # Write-Ahead Log for crash recovery
ENABLE_LMF_CONSOLIDATOR=false       # Periodic memory consolidation background job
ENABLE_LMF_BLOB=false               # Large artifact / blob storage tier

# ── Causal Analysis (requires ENABLE_LMF_CAUSAL) ─────────────────────────────
ENABLE_CAUSAL_ABSTRACTION=false     # Causal node abstraction layer
ENABLE_CAUSAL_DRIFT=false           # Distribution drift detection
ENABLE_CAUSAL_COMPRESSION=false     # Causal graph compression

# ── Governor — Advanced Modes ─────────────────────────────────────────────────
ENABLE_ADAPTIVE_GOVERNOR=false      # RL-based online policy adaptation
ENABLE_CONSENSUS_GOVERNOR=false     # Bayesian weighted multi-evaluator consensus
ENABLE_MULTI_AGENT_GOVERNOR=false   # Master governor + circuit breaker (multi-agent)

# ── Autonomy & Remediation ────────────────────────────────────────────────────
ENABLE_AUTONOMOUS_REMEDIATION=false # Auto root-cause analysis + fix planning
ENABLE_PLAN_SEARCH=false            # Beam search over the remedy action space
ENABLE_RANKED_SHADOW=false          # Thompson sampling shadow execution
ENABLE_SHADOW_RELIABILITY=false     # Shadow plan reliability metrics
ENABLE_WEIGHT_TUNING=false          # Online weight adaptation for scoring
ENABLE_COUNTERFACTUAL_LEARNING=false # Counterfactual trajectory analysis
ENABLE_CANARY_ROLLOUT=false         # Staged rollout with metric guard
ENABLE_ROLLOUT_STATS_GUARD=false    # Stats-based rollout promotion gating

# ── Planner ───────────────────────────────────────────────────────────────────
ENABLE_PLANNER=false                # Hierarchical task-graph planning engine
ENABLE_GOAL_INFERENCE=false         # Multi-hypothesis goal tracking
ENABLE_RESOURCE_REGISTRY=false      # Tool / capability inventory

# ── Proactive Intelligence ────────────────────────────────────────────────────
ENABLE_PROACTIVE=false              # Master proactive intelligence switch
ENABLE_DAILY_DRIVER=false           # Daily autonomous BLOCKER/RISK/OPPORTUNITY generation
ENABLE_SPRINT_PLANNER=false         # Weekly sprint plan generation
ENABLE_MESSAGE_CLASSIFIER=false     # Incoming message intent classification

# Proactive schedule (cron expressions, Asia/Taipei by default)
# DAILY_DRIVER_CRON=30 21 * * *    # Default 21:30 daily
# SPRINT_PLANNER_CRON=0 18 * * 0   # Default Sunday 18:00

# ── Notifications ─────────────────────────────────────────────────────────────
# Master switch — must be true for any channel to send
ENABLE_NOTIFICATIONS=false
ENABLE_SLACK_NOTIFICATIONS=false
ENABLE_TELEGRAM_NOTIFICATIONS=false
ENABLE_WEBHOOK_NOTIFICATIONS=false
ENABLE_WEBSOCKET_NOTIFICATIONS=false

# Slack Incoming Webhook
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T.../B.../...

# Telegram Bot
# TELEGRAM_BOT_TOKEN=123456789:AABBCCDDEEFFaabbccddeeff-...
# TELEGRAM_CHAT_ID=-100123456789    # User ID, group ID, or channel ID

# Generic HTTP Webhook (n8n / Make / Feishu / DingTalk / WeCom)
# NOTIFICATION_WEBHOOK_URL=https://your-webhook-endpoint.example.com/hook

# ── Skill Advanced ────────────────────────────────────────────────────────────
ENABLE_SKILL_ACL=false              # Skill access control lists (per-agent permissions)
ENABLE_SKILL_ROLLBACK=false         # Transaction-like skill rollback on failure
ENABLE_SKILL_VALIDATION=false       # Pre-execution skill input validation

# ── Resource Guard ────────────────────────────────────────────────────────────
ENABLE_RESOURCE_GUARD=false         # Enforce CPU/memory/rate limits
# RESOURCE_MAX_MEMORY_MB=512
# RESOURCE_MAX_CPU_PERCENT=80.0
# RESOURCE_MAX_SKILL_CALLS_PER_MIN=60

# ── Telemetry ─────────────────────────────────────────────────────────────────
ENABLE_TELEMETRY=false              # Prometheus / OpenTelemetry push
# TELEMETRY_ENDPOINT=http://localhost:9091  # Prometheus push gateway
# TELEMETRY_SERVICE_NAME=archillx

# ── Integrations ──────────────────────────────────────────────────────────────

# OpenClaw — distributed skill gateway
ENABLE_OPENCLAW_INTEGRATION=false
# OPENCLAW_BASE_URL=http://localhost:9000
# OPENCLAW_API_KEY=

# TRAE-Solo — agentic coding assistant gateway
ENABLE_TRAE_SOLO_INTEGRATION=false
# TRAE_SOLO_BASE_URL=http://localhost:9100
# TRAE_SOLO_API_KEY=

# Recovery / Self-healing
RECOVERY_ENABLED=false
RECOVERY_MODE=single
RECOVERY_LOCK_BACKEND=file
RECOVERY_LOCK_KEY=archillx:recovery:lock
RECOVERY_LOCK_TTL_S=30
RECOVERY_RENEW_INTERVAL_S=10
RECOVERY_HEARTBEAT_TTL_S=90
RECOVERY_READY_URL=http://127.0.0.1:8000/readyz
RECOVERY_CHECK_INTERVAL_S=5
RECOVERY_FORCE_TAKEOVER=false
RECOVERY_OFFLINE=false
REDIS_URL=


# Entropy Ops
ENTROPY_OPS_SQLITE_PATH=./evidence/entropy_ops.sqlite
ENTROPY_ALERT_WEBHOOK_URL=
ENTROPY_ALERT_COOLDOWN_S=300
